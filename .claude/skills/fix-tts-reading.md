# Skill: TTS読み上げ問題の修正

OpenAI TTSが正しく読み上げない漢字・単語を修正する手順。

## 問題の種類

1. **難読漢字**: 「血税」→「ちぜい」（誤）
2. **四字熟語**: 「厚顔無恥」→ 読めない
3. **人名**: 「高市早苗」→ 読み間違い
4. **複合語**: 「火の玉」→「かのたま」（誤）

## 修正手順

### Step 1: 問題の特定

ユーザーから報告があった場合:
- 問題の単語をメモ
- 正しい読み方を確認
- 番組タイプを確認（全番組共通か特定番組か）

### Step 2: generate-full-script.tsの修正

`api/generate-full-script.ts`を開き、TTSルールセクションに追加:

```typescript
【重要：TTSの読み方 - スクリプト内でひらがなに変換すること】
以下の漢字は**スクリプト内でひらがなに変換して出力**すること：
- 「問題の漢字」→「ひらがな読み」  // ← 追加
```

### 現在のTTSルール一覧

```
基本難読漢字:
- 「血税」→「けつぜい」
- 「捏造」→「ねつぞう」
- 「忖度」→「そんたく」
- 「揶揄」→「やゆ」
- 「糾弾」→「きゅうだん」
- 「誹謗」→「ひぼう」
- 「偏向」→「へんこう」

動詞・表現:
- 「大盤振る舞い」→「おおばんぶるまい」
- 「憤る/憤って」→「いきどおる/いきどおって」
- 「火の玉」→「ひのたま」

政治用語:
- 「媚中反日」→「びちゅうはんにち」
- 「厚顔無恥」→「こうがんむち」

人名（政治家ウオッチ用）:
- 「高市早苗」→「たかいちさなえ」
- 必要に応じて追加
```

### Step 3: 平易な言葉への置き換え指示

難読語が頻出する場合、Geminiに平易な言葉への置き換えを指示:

```typescript
【重要：平易な言葉への置き換え】
内容は大人向けのまま、難しい熟語や四字熟語は**平易な言葉に置き換える**こと：
- 難読熟語は避け、一般的な表現に言い換える
- 例：「厚顔無恥」→「恥知らず」「図々しい」
- 例：「媚中反日」→「中国寄りで日本に批判的」
- 例：「大盤振る舞い」→「気前よくばらまく」
- 四字熟語より、分かりやすい日本語表現を優先
- ラジオで聞いて一発で意味が伝わる言葉を選ぶ
```

### Step 4: チャンク境界の頭切れ対策

単語の先頭が切れる場合は、既に以下の対策が実装済み:

```typescript
// splitIntoChunks関数
return chunks.map((chunk, index) => {
  if (index === 0) return chunk;
  return '　' + chunk;  // 全角スペースで小休止
});
```

それでも問題が残る場合:
1. チャンクサイズを小さくする（2000→1500）
2. 分割位置を文末のみに限定
3. チャンク先頭に「...」を追加

### Step 5: テスト

1. Vercelデプロイを待つ（自動）
2. 番組を再生成
3. 問題の単語が正しく読まれるか確認

## よくある読み間違いパターン

| 漢字 | TTSの誤読 | 正しい読み |
|------|-----------|------------|
| 血税 | ちぜい | けつぜい |
| 火の玉 | かのたま | ひのたま |
| 大盤振る舞い | だいばんぶるまい | おおばんぶるまい |
| 揶揄 | やゆ（途切れる） | やゆ |
| 憤る | いかる | いきどおる |

## 注意事項

1. **全番組に適用**: TTSルールは全番組タイプで共有
2. **ひらがな変換が優先**: 平易な言葉への置き換えより確実
3. **テストは実際に聴く**: 目視確認だけでは不十分
4. **累積的に追加**: 新しい問題が見つかるたびにルール追加

## 関連ファイル

- `/api/generate-full-script.ts` - TTSルール定義
- `/src/components/AudioPlayer.tsx` - 音声再生
